(()=>{"use strict";class e{static getURL(e){return browser.runtime.getURL(e)}static get(t){return fetch(e.getURL(t))}static getJSON(t){return e.get(t).then((e=>e.json()))}static getText(t){return e.get(t).then((e=>e.text()))}}class t{static escape(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,(e=>t[e]))}static fragment(e){const t=document.createElement("template");return t.innerHTML=DOMPurify.sanitize(e),t.content}static element(e){return t.fragment(e).firstElementChild}static _getNode(e){let t=e;return null==t?(console.warn(t+" is not an Element."),null):("string"==typeof t&&(t=document.querySelector(t)),t instanceof Element?t:(console.warn(t+" is not an Element."),null))}static inner(e,s){const o=t._getNode(e);return o&&(o.innerHTML=DOMPurify.sanitize(s)),o}static replace(e,s){const o=t._getNode(e);return o&&(o.outerHTML=DOMPurify.sanitize(s)),o}static wrap(e,s){const o=t._getNode(e);if(o){const e=t.element(s);return o.replaceWith(e),e.append(o),e}return o}static adjacent(e,s,o){const i=t._getNode(e);return i&&i.insertAdjacentHTML(s,DOMPurify.sanitize(o)),i}static beforeBegin(e,s){t.adjacent(e,"beforebegin",s)}static afterBegin(e,s){t.adjacent(e,"afterbegin",s)}static beforeEnd(e,s){t.adjacent(e,"beforeend",s)}static afterEnd(e,s){t.adjacent(e,"afterend",s)}}class s{async build(){const s=await e.getJSON("changelog.json");let o="";for(const[e,t]of Object.entries(s))o+=`\n                <h2>${e}</h2>\n                <div>${t}</div>\n            `;t.inner(document.querySelector(".js-changelog"),o)}}Error,Error,Error,Error;class o{static get(e,t){const s=e.trim();return o.cache.has(s)?o.cache.get(s):t}static set(e,t,s=31536e3){let i=e.trim(),n=t.trim();o.cache.set(i,n),i=encodeURIComponent(i),n=encodeURIComponent(n),document.cookie=`${i}=${n}; max-age=${s}`}static remove(e){let t=e.trim();o.cache.delete(t),t=encodeURIComponent(t),document.cookie=t+"; expires=Thu, 01 Jan 1970 00:00:00 GMT"}static init(){o.cache=new Map;for(let[e,t]of document.cookie.split(";").map((e=>e.split("="))))e=e.trim(),o.cache.set(e,decodeURIComponent(t))}}o.init();const i=Object.freeze({BACKGROUND:1,CONTENT_SCRIPT:2,OPTIONS:3});let n;if(browser.extension.getBackgroundPage){const e=browser.extension.getBackgroundPage();n=e===window?i.BACKGROUND:i.OPTIONS}else n=i.CONTENT_SCRIPT;class a{static getCurrentSteamLanguage(){if(null!==this._currentSteamLanguage)return this._currentSteamLanguage;for(const e of document.querySelectorAll("script[src]")){const t=new URL(e.src).searchParams.get("l");if(t)return a._currentSteamLanguage=t,this._currentSteamLanguage}return class{static isBackgroundScript(){return n===i.BACKGROUND}static isContentScript(){return n===i.CONTENT_SCRIPT}static isOptions(){return n===i.OPTIONS}}.isContentScript()&&(a._currentSteamLanguage=o.get("Steam_Language")||null),this._currentSteamLanguage}static getLanguageCode(e){return a.languages[e]||"en"}static isCurrentLanguageOneOf(e){return e.includes(a.getCurrentSteamLanguage())}}a._currentSteamLanguage=null,a.languages={english:"en",bulgarian:"bg",czech:"cs",danish:"da",dutch:"nl",finnish:"fi",french:"fr",greek:"el",german:"de",hungarian:"hu",italian:"it",japanese:"ja",koreana:"ko",norwegian:"no",polish:"pl",portuguese:"pt-PT",brazilian:"pt-BR",russian:"ru",romanian:"ro",schinese:"zh-CN",spanish:"es-ES",latam:"es-419",swedish:"sv-SE",tchinese:"zh-TW",thai:"th",turkish:"tr",ukrainian:"ua",vietnamese:"vi"};class r{static message(e){return browser.runtime.sendMessage(e)}static action(e,...t){return t.length?this.message({action:e,params:t}):this.message({action:e})}}const c={version:browser.runtime.getManifest().version,db_version:3};class l{static has(e){return Object.prototype.hasOwnProperty.call(this._cache,e)}static get(e){return void 0===this._cache[e]?(void 0===this.defaults[e]&&console.warn(`Unrecognized SyncedStorage key "${e}"`),this.defaults[e]):this._cache[e]}static set(e,t){return this._cache[e]=t,this._adapter.set({[e]:t})}static import(e){for(const[t,s]of Object.entries(e))this._cache[t]=s;return this._adapter.set(e)}static remove(e){return void 0!==this._cache[e]&&delete this._cache[e],this._adapter.remove(e)}static keys(e=""){return Object.keys(this._cache).filter((t=>t.startsWith(e)))}static entries(){return Object.entries(this._cache)}static async clear(e=!1){let t;e?this._cache={}:t=this.persistent.reduce(((e,t)=>(e[t]=this._cache[t],e)),{}),await this._adapter.clear(),e||await this.import(t)}static async init(){browser.storage.onChanged.addListener((e=>{for(const[t,{newValue:s}]of Object.entries(e))this._cache[t]=s}));const e=await this._adapter.get(null);return Object.assign(this._cache,e),this._cache}static then(e,t){return this.init().then(e,t)}static toJson(){return JSON.stringify(this._cache)}}l.QUOTA_BYTES_PER_ITEM=8192,l._adapter=browser.storage.sync||browser.storage.local,l._cache={},l.defaults=Object.freeze({language:"english",version:c.version,version_show:!0,highlight_owned_color:"#00ce67",highlight_wishlist_color:"#0491bf",highlight_coupon_color:"#a26426",highlight_inv_gift_color:"#800040",highlight_inv_guestpass_color:"#513c73",highlight_notinterested_color:"#4f4f4f",highlight_collection_color:"#856d0e",highlight_waitlist_color:"#4c7521",tag_owned_color:"#00b75b",tag_wishlist_color:"#0383b4",tag_coupon_color:"#c27120",tag_inv_gift_color:"#b10059",tag_inv_guestpass_color:"#65449a",tag_notinterested_color:"#4f4f4f",tag_collection_color:"#856d0e",tag_waitlist_color:"#4c7521",highlight_owned:!0,highlight_wishlist:!0,highlight_coupon:!1,highlight_inv_gift:!1,highlight_inv_guestpass:!1,highlight_notinterested:!1,highlight_excludef2p:!1,highlight_collection:!0,highlight_waitlist:!0,tag_owned:!1,tag_wishlist:!1,tag_coupon:!1,tag_inv_gift:!1,tag_inv_guestpass:!1,tag_notinterested:!0,tag_collection:!1,tag_waitlist:!1,tag_short:!1,hidetmsymbols:!1,showlowestprice:!0,showlowestprice_onwishlist:!0,showlowestpricecoupon:!0,showallstores:!0,stores:[],override_price:"auto",showregionalprice:"mouse",regional_countries:["us","gb","ru","br","au","jp"],show_es_homepagetabs:!0,showmarkettotal:!1,showsteamrepapi:!0,showmcus:!0,showoc:!0,showhltb:!0,showyoutube:!0,showtwitch:!0,showpcgw:!0,showcompletionistme:!1,showprotondb:!1,showviewinlibrary:!1,showsteamcardexchange:!1,showitadlinks:!0,showsteamdb:!0,showbartervg:!1,showastatslink:!0,showyoutubegameplay:!0,showyoutubereviews:!0,showwsgf:!0,exfgls:!0,app_custom_link:[{enabled:!1,name:"Google",url:"google.com/search?q=[ID]+[NAME]",icon:"www.google.com/images/branding/product/ico/googleg_lodp.ico"}],customize_apppage:{recentupdates:!0,reviews:!0,about:!0,contentwarning:!0,steamchart:!0,steamspy:!0,surveys:!0,sysreq:!0,legal:!0,morelikethis:!0,recommendedbycurators:!0,customerreviews:!0},customize_frontpage:{featuredrecommended:!0,specialoffers:!0,trendingamongfriends:!0,discoveryqueue:!0,browsesteam:!0,curators:!0,morecuratorrecommendations:!0,recentlyupdated:!0,fromdevelopersandpublishersthatyouknow:!0,popularvrgames:!0,homepagetabs:!0,gamesstreamingnow:!0,under:!0,updatesandoffers:!0,homepagesidebar:!0},show_package_info:!1,show_steamchart_info:!0,show_steamspy_info:!0,show_early_access:!0,show_alternative_linux_icon:!1,show_itad_button:!1,skip_got_steam:!1,installsteam:"show",openinnewtab:!1,keepssachecked:!1,showemptywishlist:!0,user_notes_app:!0,user_notes_wishlist:!0,showwishliststats:!0,user_notes:{},user_notes_adapter:"synced_storage",replaceaccountname:!0,showlanguagewarning:!0,showlanguagewarninglanguage:"english",homepage_tab_selection:"remember",homepage_tab_last:null,send_age_info:!0,removebroadcasts:!1,mp4video:!1,horizontalscrolling:!0,showsupportinfo:!0,showdrm:!0,regional_hideworld:!1,showinvnav:!0,quickinv:!0,quickinv_diff:-.01,community_default_tab:"",showallachievements:!1,showallstats:!0,showachinstore:!0,showcomparelinks:!1,hideactivelistings:!1,showlowestmarketprice:!0,hidespamcomments:!1,spamcommentregex:"[\\u2500-\\u25FF]",wlbuttoncommunityapp:!0,removeguideslanguagefilter:!1,disablelinkfilter:!1,sortfriendsby:"default_ASC",sortreviewsby:"default_ASC",sortgroupsby:"default_ASC",show1clickgoo:!0,show_profile_link_images:"gray",show_custom_themes:!0,profile_steamrepcn:!0,profile_steamgifts:!0,profile_steamtrades:!0,profile_bartervg:!0,profile_steamrep:!0,profile_steamdbcalc:!0,profile_astats:!0,profile_backpacktf:!0,profile_astatsnl:!0,profile_steamid:!0,profile_custom_link:[{enabled:!0,name:"Google",url:"google.com/search?q=[ID]",icon:"www.google.com/images/branding/product/ico/googleg_lodp.ico"}],fav_emoticons:[],group_steamgifts:!0,steamcardexchange:!0,purchase_dates:!0,show_badge_progress:!0,show_coupon:!0,show_wishlist_link:!0,show_wishlist_count:!0,show_progressbar:!0,show_backtotop:!1,profile_showcase_twitch:!0,profile_showcase_own_twitch:!1,profile_showcase_twitch_profileonly:!1,itad_import_library:!1,itad_import_wishlist:!1,add_to_waitlist:!1,context_steam_store:!1,context_steam_market:!1,context_itad:!1,context_bartervg:!1,context_steamdb:!1,context_steamdb_instant:!1,context_steam_keys:!1}),l.persistent=["user_notes","user_notes_adapter"];class d{static loadLocalization(t){return e.getJSON(`/localization/${t}.json`)}static init(){if(d._promise)return d._promise;let e=a.getCurrentSteamLanguage();const t=l.get("language");function s(e,t){for(const[o,i]of Object.entries(t))void 0!==e[o]?"object"==typeof i?s(e[o],i):""!==i&&(e[o]=i):console.warn("The key %s doesn't exist in the English localization file",o);return e}null===e?e=t:e!==t&&(l.set("language",e),r.action("clearpurchases"));const o=a.getLanguageCode(e),i=["en"];return null!==o&&"en"!==o&&i.push(o),d._promise=Promise.all(i.map((e=>d.loadLocalization(e)))).then((([e,t])=>(d.str=e,t&&s(d.str,t),d.str))),d._promise}static then(e,t){return d.init().then(e,t)}static getString(e){const t=e.split(".").reverse();let s=d.str;for(;t.length;){if("object"!=typeof s)return null;s=s[t.pop()]}return s}}d._promise=null;class u{constructor(e){this._promise=new Promise((t=>{this._id=setTimeout((()=>{t()}),e)}))}then(e,t){if(this._promise)return this._promise.then(e,t);throw new Error("Timer has been cleared before")}clear(){clearTimeout(this._id),this._promise=null}}class h{constructor(e,t){this.onDone=e,this.duration=t,this.reset()}get running(){return this._running}reset(){void 0!==this._id&&clearTimeout(this._id),this._id=setTimeout((async()=>{await this.onDone(),this._running=!1}),this.duration),this._running=!0}}class _{static timer(e){return new u(e)}static resettableTimer(e,t){return new h(e,t)}static now(){return Math.trunc(Date.now()/1e3)}}const g=Object.freeze({context_steam_store:{persistent:!0,permissions:["contextMenus"]},context_steam_market:{persistent:!0,permissions:["contextMenus"]},context_itad:{persistent:!0,permissions:["contextMenus"]},context_bartervg:{persistent:!0,permissions:["contextMenus"]},context_steamdb:{persistent:!0,permissions:["contextMenus"]},context_steamdb_instant:{persistent:!0,permissions:["contextMenus"]},context_steam_keys:{persistent:!0,permissions:["contextMenus"]}});class m{static contains(e){return browser.permissions.contains({permissions:e})}static async request(e){return!!await this.contains(e)||browser.permissions.request({permissions:e})}static remove(e){return e.includes("contextMenus")&&browser.contextMenus.removeAll(),browser.permissions.remove({permissions:e})}static async when(e,t,s){t&&(await m.contains([e])&&t(),browser.permissions.onAdded.addListener((s=>{s.permissions.includes(e)&&t()}))),s&&browser.permissions.onRemoved.addListener((t=>{t.permissions.includes(e)&&s()}))}static requestOption(e){return m.request(g[e].permissions)}static removeOption(e){const t=m._getUnusedPermissions(e);return 0===t.length?Promise.resolve(!0):m.remove(t)}static _getUnusedPermissions(e){const t=new Set;for(const[s,o]of Object.entries(g))if(e!==s&&(!o.persistent||l.get(s)))for(const e of o.permissions)t.add(e);const s=new Set;for(const o of g[e].permissions)t.has(o)||s.add(o);return Array.from(s.values())}}class p{static async applyCSSTransition(e,t,s,o,i){return e.style.transition="",e.style[t]=s,await _.timer(0),e.style.transition=`${t} ${i}ms`,e.style[t]=o,_.timer(i)}static fadeIn(e,t=400){return p.applyCSSTransition(e,"opacity",0,1,t)}static async fadeOut(e,t=400){await p.applyCSSTransition(e,"opacity",1,0,t)}static async fadeInFadeOut(e,t=400,s=400,o=600){const i=Date.now().toString();e.dataset.fadeControl=i,p.fadeIn(e,t),await _.timer(t+o),e.dataset.fadeControl===i&&p.fadeOut(e,s)}}class w{static saving(){this._currentSaves++>0||(document.querySelector(".js-options-saving").classList.remove("is-hidden"),document.querySelector(".js-options-saved").classList.add("is-hidden"),this._promise=p.fadeIn(document.querySelector(".js-options-save")))}static async saved(){--this._currentSaves>0||(document.querySelector(".js-options-saving").classList.add("is-hidden"),document.querySelector(".js-options-saved").classList.remove("is-hidden"),await this._promise,this._promise=null,await _.timer(this.displayTime),null===this._promise&&p.fadeOut(document.querySelector(".js-options-save")))}}w.displayTime=600,w._promise=null,w._currentSaves=0;class f{constructor(e){this._container=e,this._type=e.dataset.type}init(){this._template=t.element(`<div class="custom-link option js-custom-link">\n                <input type="checkbox" name="${this._type}_custom_enabled">\n                <div>\n                    <div>\n                        <label class="custom-link__label">${d.str.options.name}</label>\n                        <input class="custom-link__input" type="text" name="${this._type}_custom_name" maxlength="30">\n                    </div>\n                    <div>\n                        <label class="custom-link__label">URL</label>\n                        <input class="custom-link__input" type="text" name="${this._type}_custom_url">\n                    </div>\n                    <div>\n                        <label class="custom-link__label">${d.str.options.icon}</label>\n                        <input class="custom-link__input" type="text" name="${this._type}_custom_icon">\n                    </div>\n                </div>\n                <button class="custom-link__close js-custom-link-remove"></button>\n            </div>`),this._container.addEventListener("click",(({target:e})=>{e.classList&&e.classList.contains("js-custom-link-remove")&&(e.closest(".js-custom-link").remove(),this._save())})),this._container.addEventListener("change",(({target:e})=>{e.closest(".js-custom-link")&&this._save()})),document.querySelector(`.js-${this._type}-custom-link-add`).addEventListener("click",(()=>{this._create(l.defaults[this._type+"_custom_link"][0]),this._save()}))}populate(){t.inner(this._container,"");const e=l.get(this._type+"_custom_link");for(const t of e)this._create(t)}_create(e){const t=this._template.cloneNode(!0);let s=e.url;s&&!s.includes("[ID]")&&(s+="[ID]"),t.querySelector(`[name="${this._type}_custom_enabled"]`).checked=e.enabled,t.querySelector(`[name="${this._type}_custom_name"]`).value=e.name,t.querySelector(`[name="${this._type}_custom_url"]`).value=s,t.querySelector(`[name="${this._type}_custom_icon"]`).value=e.icon,this._container.append(t)}_read(e){return{enabled:e.querySelector(`[name="${this._type}_custom_enabled"]`).checked,name:e.querySelector(`[name="${this._type}_custom_name"]`).value,url:e.querySelector(`[name="${this._type}_custom_url"]`).value,icon:e.querySelector(`[name="${this._type}_custom_icon"]`).value}}_save(){const e=this._container.querySelectorAll(".js-custom-link"),t=[];for(const s of e){const e=this._read(s);(e.enabled||e.name||e.url||e.icon)&&t.push(e)}l.set(this._type+"_custom_link",t),w.saved()}}class b{constructor(){const[e,t]=document.querySelectorAll(".js-itad-status, .js-itad-action");this._itadStatus=e,this._itadAction=t}async _clickHandler(){const e=this._itadStatus.classList.contains("itad-status--disconnected");e?await r.action("itad.authorize"):await r.action("itad.disconnect"),this._itadStatus.textContent=e?d.str.connected:d.str.disconnected,this._itadAction.textContent=e?d.str.disconnect:d.str.connect,this._itadStatus.classList.toggle("itad-status--disconnected",!e),this._itadStatus.classList.toggle("itad-status--connected",e)}async run(){await r.action("itad.isconnected")?(this._itadStatus.textContent=d.str.connected,this._itadAction.textContent=d.str.disconnect,this._itadStatus.classList.add("itad-status--connected")):(this._itadStatus.textContent=d.str.disconnected,this._itadAction.textContent=d.str.connect,this._itadStatus.classList.add("itad-status--disconnected")),this._itadAction.addEventListener("click",(()=>{this._clickHandler()}))}}const y={brazilian:"Berna, Mougevit, Ricci, Rubens Vinícius, Scopel, Titoncio, Yachagon, xAranda(NO AUDIO), 級 Happy, Greg Strider, Luís, Matheus R., Rahone Marcelino",bulgarian:"Castro Wilde, The Nominomicon, XepouH, sappy",czech:"Arcane, Bezdak, Martin005[CZ], benetti32|cz, chriss01cz, dapil, xXx_Pá$0v€cXVI_xXx",danish:"Cake!, Chreddy, Mig_Mikkel [⇄], Redzdaz, Saturate, SnoX, UltraSun, XDRosenheim, antim",dutch:"AreUTalking2Meh, Bennievv, Boelens, Craven, Epicon, FooBar, HumanaSays, Justin, Nujj, Yeuxkes, Dylwan, Revadike",finnish:"3ventic, Elekton, Hilloh, Lumppari, Mairo vain..., Major Parsnip, Master Indigo, Nightmare_182, NikoDaGreat, Tumpo, frozen.aerocrane, mkfin",french:"Clockmaker, Nuator, Quaelor, Stumpokapow, Vardex, Yanuut, eucalyptux",german:"Darkbird |, Edward Cullen, FuriousFry, Gatse, Incredipede, Invisi, MAGIC, Phenom, Pilzsuppe, Schnitzelfee, Son of Thor, addicT*, chrisli, dochris.2, larry_ @ DUAS NIMMA HALTEN, red, |«ScReaM»|, À Cookie Jar",greek:"Coccinella, Pandorian, SeCTeen, Sub-Zero, George",hungarian:"DonRoland, Mohariczozo_HUN, Noarpe, Sirpi, [T-A!] Underyx x 6, atomcsikk, french_salad, nArrow, ๖VaHooK, Haewen",italian:"Copons, Drake Fazuku, Rasin, Star1s3, Øktøber, Andrea Brandi, GiorgioBrux, Manfre",japanese:"aoisensi, k725, sumannnala, Aufallinger",koreana:"CanNaJun, Daum, Hirano, LJreal, RaWouk, Rasin, [GF]meyoung, fivestar, sunk, À Cookie Jar, 하얀군주",latam:"Dilubar",norwegian:"KappaHD, Lazberg, Morten242, Stian, ⑨ ChocolateShuvuu",polish:"AciD, Bednar, Laserman//^^, Lordomus, Parseus, Xylo, Yobilat, Yocki, devLewy, mahon, skubi07, przemo20, BeWu, Przemysław Siekiera",portuguese:"Dr. Costa, Ex0tic, Matias G. H., MrAltamente, Reckoner, Sim, SupSuper, TheScientist, The_Monk, TilenoL, mgiovani",romanian:"Stormania",russian:"Engkariensis, Kosheyaka, M@gi$te® Y0d@, Mechanic, Memfys, MrFreemanBBQ, Robin, Sh1fter, ShawNexT, The Freak, TheMrKochan, delfin_00, dragonsigh, Asscrab, maximmax42, Ryzhehvost, Vlad",schinese:"Aslike2, Deparsoul, FelinaeEbony, Gold, Iuy, M@nkey, Mr. Error, MyLittleWarhammer, Rabbitism Bomb, Rasin, [CN]Johnson, i7killpii, mjy, ssenkrad, yuccatoo, deluxghost, Cattī Crūdēlēs, Aufallinger, JackyTsu",spanish:'#SG# Sharkiller, 00HiZaM, Alien8, Digmin3, ItsMarukka, Kharn Nete, MλXX [PA-D], Profesor Pistacho, Robotnick, Silence, \\Vince, giraam, kalprestito, kulapik, p0tat0, wasakakero, xGreg, Eugenio "Ryo567" Martínez Seguín, Raúl, Vikandus',swedish:"Chainsawkitten, Death King, Deques, Lumppari, [MG] Rubiin, 전주 0x3 제",tchinese:"Atraveller, JD OwO, Lex Song, MoDMeR, Mr. Error, NOKIA SE, Rasin, omylist, tonyli1357, 破曉之殤丶Revelation, Cattī Crūdēlēs, Gaz, candela97, omylist",thai:"Epicenter, Likecyber, Magnative, Radius, Rasin, [LPG] 7-elephant, [D-M-C]",turkish:"Beedle, Dijkstra[TR], Eray, Gevanni, Grievous, Neadiatre[Trade] #SOMA, Sound of Night, Su1ciDe, eayurdaer, tyyaman, veteran, ÖŞEK YALANCI, Müslüm Barış Korkmazer, Serdar Sağlam, Volkangezer",ukrainian:"Anakin Skywalker, BlackSwan, Dorimi, Gentleneer, GreK™, MoDMeR, NutsUA, Peacefool Peopel, Smith M.D., Stakan, [BA]zekainhuman, Ryzhehvost, Taras",vietnamese:"Connorn3794, Khanh Nguyen"};class v{constructor(){this._total=this._deepCount(d.str)}_deepCount(e){let t=0;for(const s of Object.keys(e))d.str[s]&&("object"==typeof e[s]?t+=this._deepCount(e[s]):""!==e[s]&&t++);return t}async _computeCoverage(e){if("english"===e)return 100;const t=a.languages[e],s=await d.loadLocalization(t);return 100*this._deepCount(s)/this._total}async build(){let e="";for(const[t,s]of Object.entries(y)){const o=await this._computeCoverage(t);e+=`\n                <div class="lang js-lang">\n                    <h2 class="lang__name">${d.str.options.lang[t]}</h2>\n                    <div class="lang__perc js-lang-perc">${o.toFixed(1)}%</div>\n                    <div class="lang__credits">${s}</div>\n                </div>`}t.inner(document.querySelector(".js-credits-locale"),e)}}const S={show_progressbar:"show_progressbar",version_show:"options.version_show",replaceaccountname:"options.replace_account_name",show_backtotop:"options.show_backtotop",disablelinkfilter:"options.disablelinkfilter",send_age_info:"options.send_age_info",openinnewtab:"options.openinnewtab",installsteam:["options.install_steam_button",[["show","show"],["hide","hide"],["replace","options.replace_view_client"]]],context_steam_store:"options.context_steam_store",context_itad:"options.context_itad",context_bartervg:"options.context_bartervg",context_steamdb:"options.context_steamdb",context_steamdb_instant:"options.context_steamdb_instant",context_steam_keys:"options.context_steam_keys",itad_import_library:"library_menu",itad_import_wishlist:"wishlist",add_to_waitlist:"options.add_to_waitlist",highlight_owned:"options.owned",highlight_wishlist:"options.wishlist",highlight_coupon:"options.coupon",highlight_inv_gift:"options.gift",highlight_inv_guestpass:"options.guest",highlight_notinterested:"notinterested",highlight_collection:"options.collection",highlight_waitlist:"options.waitlist",highlight_excludef2p:"options.excludef2p",tag_owned:"options.owned",tag_wishlist:"options.wishlist",tag_coupon:"options.coupon",tag_inv_gift:"options.gift",tag_inv_guestpass:"options.guest",tag_notinterested:"notinterested",tag_collection:"options.collection",tag_waitlist:"options.waitlist",tag_short:"tag_short",hidetmsymbols:"options.hidetmsymbols",user_notes_app:"options.user_notes.app",user_notes_wishlist:"options.user_notes.wishlist",user_notes_adapter:["options.user_notes.loc",[["synced_storage","options.user_notes.synced_storage"],["idb","options.user_notes.local"]]],homepage_tab_selection:["options.homepage_default_tab",[["remember","options.homepage_default_tab_remember"],["tab_newreleases_content_trigger","options.homepage_default_tab_newreleases"],["tab_topsellers_content_trigger","options.homepage_default_tab_topsellers"],["tab_upcoming_content_trigger","options.homepage_default_tab_upcoming"],["tab_specials_content_trigger","options.homepage_default_tab_specials"]]],showemptywishlist:"options.show_empty_wishlist",showwishliststats:"options.show_wishlist_stats",mp4video:"options.mp4video",showsupportinfo:"options.supportinfo",showdrm:"options.drm",showviewinlibrary:"options.show_view_in_library",show_package_info:"options.show_package_info",showachinstore:"achievements.option",purchase_dates:"options.purchase_dates",show_badge_progress:"options.show_badge_progress",show_coupon:"options.show_coupon",removebroadcasts:"options.removebroadcasts",exfgls:"options.exfgls",showmcus:"options.metacritic",showoc:"options.opencritic",showhltb:"options.hltb",showitadlinks:"options.itadlinks",showsteamdb:"options.steamdb",showbartervg:"options.showbartervg",showastatslink:"options.show_astatslink",showyoutubegameplay:"options.show_youtubegameplay",showyoutubereviews:"options.show_youtubereviews",showyoutube:"options.youtube",showtwitch:"options.twitch",showpcgw:"options.pcgw",showcompletionistme:"options.completionistme",showprotondb:"options.protondb",showwsgf:"options.wsgf",showsteamcardexchange:"options.store_steamcards",show_steamchart_info:"options.show_steamchart_info",show_steamspy_info:"options.show_steamspy_info",horizontalscrolling:"options.horizontalscrolling",show_early_access:"options.show_early_access",show_alternative_linux_icon:"options.show_alternative_linux_icon",skip_got_steam:"options.skip_got_steam",showlowestprice:"options.lowestprice",showlowestprice_onwishlist:"options.lowestprice_onwishlist",showlowestpricecoupon:"options.lowestprice_coupon",showallstores:"options.stores_all",regional_hideworld:"options.regional_hideworld",showregionalprice:["options.regional_price_on",[["mouse","options.regional_price_mouse"],["always","always"],["off","never"]]],showmarkettotal:"options.market_total",hideactivelistings:"options.hideactivelistings",showlowestmarketprice:"options.showlowestmarketprice",quickinv:"options.quickinv",show1clickgoo:"options.show1clickgoo",showinvnav:"options.inventory_nav_text",show_wishlist_link:"options.show_wishlist_link",show_wishlist_count:"options.show_wishlist_count",showsteamrepapi:"options.steamrepapi",show_custom_themes:"options.show_custom_themes",profile_steamid:"options.profile_steamid",profile_showcase_twitch:"options.profile_showcase_twitch",profile_showcase_own_twitch:"options.profile_showcase_own_twitch",profile_showcase_twitch_profileonly:"options.profile_showcase_twitch_profileonly",show_profile_link_images:["options.profile_link_images",[["gray","options.profile_link_images_gray"],["color","options.profile_link_images_color"],["none","options.profile_link_images_none"]]],community_default_tab:["options.community_default_tab",[["","all"],["discussions","discussions"],["screenshots","options.screenshots"],["images","options.artwork"],["broadcasts","options.broadcasts"],["videos","options.videos"],["workshop","workshop.workshop"],["allnews","news"],["guides","guides"],["reviews","reviews"]]],showallachievements:"options.showallachievements",showallstats:"options.showallstats",showcomparelinks:"options.showcomparelinks",hidespamcomments:"options.hidespamcomments",steamcardexchange:"options.steamcardexchange",wlbuttoncommunityapp:"options.wlbuttoncommunityapp",removeguideslanguagefilter:"options.removeguideslanguagefilter"};class k{static getTranslation(e){let t=d.getString(e);return t?(e.startsWith("options.context_")&&(t=t.replace("__query__","...")),t):(console.error("Missing translation for %s",e),null)}static _localizeText(){const e=document.querySelectorAll("[data-locale-text]");for(const t of e){const e=this.getTranslation(t.dataset.localeText);e&&(t.textContent=e)}}static _localizeHtml(){const e=document.querySelectorAll("[data-locale-html]");for(const s of e){const e=this.getTranslation(s.dataset.localeHtml);e&&t.inner(s,e)}}static _localizeLanguageOptions(){const e=document.querySelectorAll("#warning_language option");for(const t of e){const e=t.textContent,s=d.str.options.lang[t.value.toLowerCase()];e!==s&&(t.textContent=`${e} (${s})`)}}static translate(){document.title="Augmented Steam "+d.str.thewordoptions,this._localizeText(),this._localizeHtml(),this._localizeLanguageOptions(),t.inner(document.querySelector(".js-contributors-text"),d.getString("options.with_help_of").replace("__contributors__",`<a href='https://github.com/tfedor/AugmentedSteam/graphs/contributors'>${d.getString("options.contributors")}</a>`))}}const L={"":"None",af:"Afghanistan",al:"Albania",dz:"Algeria",as:"American Samoa",ad:"Andorra",ao:"Angola",ai:"Anguilla",ag:"Antigua and Barbuda",ar:"Argentina",am:"Armenia",aw:"Aruba",au:"Australia",at:"Austria",az:"Azerbaijan",bs:"Bahamas",bh:"Bahrain",bd:"Bangladesh",bb:"Barbados",by:"Belarus",be:"Belgium",bz:"Belize",bj:"Benin",bm:"Bermuda",bt:"Bhutan",bo:"Bolivia",ba:"Bosnia and Herzegovina",bw:"Botswana",bv:"Bouvet Island",br:"Brazil",io:"British Indian Ocean Territory",vg:"British Virgin Islands",bn:"Brunei",bg:"Bulgaria",bf:"Burkina Faso",bi:"Burundi",kh:"Cambodia",cm:"Cameroon",ca:"Canada",cv:"Cape Verde",ky:"Cayman Islands",cf:"Central African Republic",td:"Chad",cl:"Chile",cn:"China",co:"Colombia",km:"Comoros",cg:"Congo - Brazzaville",cd:"Congo - Kinshasa",ck:"Cook Islands",cr:"Costa Rica",hr:"Croatia",cu:"Cuba",cy:"Cyprus",cz:"Czech Republic",ci:"Côte d’Ivoire",dk:"Denmark",dj:"Djibouti",dm:"Dominica",do:"Dominican Republic",ec:"Ecuador",eg:"Egypt",sv:"El Salvador",gq:"Equatorial Guinea",er:"Eritrea",ee:"Estonia",et:"Ethiopia",fk:"Falkland Islands",fo:"Faroe Islands",fj:"Fiji",fi:"Finland",fr:"France",gf:"French Guiana",pf:"French Polynesia",tf:"French Southern Territories",ga:"Gabon",gm:"Gambia",ge:"Georgia",de:"Germany",gh:"Ghana",gi:"Gibraltar",gr:"Greece",gl:"Greenland",gd:"Grenada",gp:"Guadeloupe",gu:"Guam",gt:"Guatemala",gg:"Guernsey",gn:"Guinea",gw:"Guinea-Bissau",gy:"Guyana",ht:"Haiti",hm:"Heard Island and McDonald Islands",hn:"Honduras",hk:"Hong Kong SAR China",hu:"Hungary",is:"Iceland",in:"India",id:"Indonesia",ir:"Iran",iq:"Iraq",ie:"Ireland",im:"Isle of Man",il:"Israel",it:"Italy",jm:"Jamaica",jp:"Japan",je:"Jersey",jo:"Jordan",kz:"Kazakhstan",ke:"Kenya",ki:"Kiribati",kw:"Kuwait",kg:"Kyrgyzstan",la:"Laos",lv:"Latvia",lb:"Lebanon",ls:"Lesotho",lr:"Liberia",ly:"Libya",li:"Liechtenstein",lt:"Lithuania",lu:"Luxembourg",mo:"Macau SAR China",mk:"Macedonia",mg:"Madagascar",mw:"Malawi",my:"Malaysia",mv:"Maldives",ml:"Mali",mt:"Malta",mh:"Marshall Islands",mq:"Martinique",mr:"Mauritania",mu:"Mauritius",yt:"Mayotte",mx:"Mexico",fm:"Micronesia",md:"Moldova",mc:"Monaco",mn:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar [Burma]",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",KP:"North Korea",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territories",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn Islands",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RO:"Romania",RU:"Russia",RW:"Rwanda",RE:"Réunion",SH:"Saint Helena",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia",KR:"South Korea",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syria",ST:"São Tomé and Príncipe",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UM:"U.S. Minor Outlying Islands",VI:"U.S. Virgin Islands",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VA:"Vatican City",VE:"Venezuela",VN:"Vietnam",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"};class x{static init(){this._container=document.querySelector(".js-regions"),this._container.addEventListener("click",(e=>{x._removeHandler(e)})),this._container.addEventListener("change",(e=>{const t=e.target.closest(".js-region-parent");t&&x._changeFlag(t.querySelector(".es-flag"),e.target),this._save()})),document.querySelector(".js-region-add").addEventListener("click",(()=>{x._addRegionHtml("")})),document.querySelector(".js-region-reset").addEventListener("click",(()=>{x.loadDefault(),x._save()})),document.querySelector(".js-region-clear").addEventListener("click",(()=>{x._clear(),x._save()}))}static loadDefault(){this._clear(),l.remove("regional_countries"),this.populate()}static _changeFlag(e,t){e.className="",e.classList.add("es-flag--"+t.value,"es-flag")}static _removeHandler(e){e.target&&e.target.classList&&e.target.classList.contains("js-region-remove")&&(e.target.closest(".js-region-parent").remove(),this._save())}static _save(){const e=[],t=document.querySelectorAll(".js-region");for(const s of t)s.value&&""!==s.value&&e.push(s.value);l.set("regional_countries",e),w.saved()}static _clear(){t.inner(this._container,"")}static _addRegionHtml(e){let s="";for(const t in L){const o=t.toLowerCase()===e?" selected='selected'":"";s+=`<option value='${t.toLowerCase()}'${o}>${L[t]}</option>`}let o="";e&&(o="es-flag--"+e);const i=` <div class="option js-region-parent">\n                    <span class='es-flag ${o}'></span>\n                    <select class='option__region js-region'>${s}</select>\n                    <button type="button" class="custom-link__close js-region-remove"></button>\n                </div>`;t.beforeEnd(this._container,i)}static populate(){this._clear();const e=l.get("regional_countries");for(const t of e)this._addRegionHtml(t)}}class C{static _scrollTo(e){if(!e)return;const t=window.scrollY+e.getBoundingClientRect().top-50;window.scrollTo({top:t,left:0,behavior:"smooth"})}static _highlight(e,t){const s=document.querySelector(".js-sb-sec.is-selected");if(s===t)return;s&&s.classList.remove("is-selected"),t.classList.add("is-selected");const o=document.querySelector(".js-section.is-highlighted");o&&o.classList.remove("is-highlighted"),e.classList.add("is-highlighted")}static _handleClick(e){C._handleCategoryClick(e),C._handleSectionClick(e)}static _handleCategoryClick(e){const t=e.target.closest(".js-sb-cat");if(null===t)return;const s=t.dataset.id,o=document.querySelector(`.js-content[data-id='${s}']`).closest(".js-page"),i=document.querySelector(".js-page.is-open"),n=t.closest(".js-sb-grp"),a=n.querySelector(".js-sb-sections");if(o!==i){i.classList.remove("is-open"),o.classList.add("is-open");const e=document.querySelectorAll(".js-sb-grp.is-selected");for(const t of e)t.classList.remove("is-selected");a?C._scrollTo(o):window.scrollTo(0,0)}n.classList.toggle("is-selected")}static _handleSectionClick(e){const t=e.target.closest(".js-sb-sec");if(t&&t.closest(".js-sb-grp"))for(const[e,s]of C._contentNodes)if(s===t)return void C._scrollTo(e)}static _scrollHandler(){this._timer?this._timer.running||this._timer.reset():this._timer=_.resettableTimer((()=>{for(const[e,t]of C._contentNodes){const s=e.getBoundingClientRect();if(s.top<0&&s.bottom>window.innerHeight||s.top>0)return void C._highlight(e,t)}}),100)}static create(){C._contentNodes=[];const e=[["general","options.general"],["store","store"],["price","price"],["community","community"],["news","news"],["about","about"]],s=document.querySelector(".js-sb");for(const[o,i]of e){const e=document.querySelector(`.js-content[data-id='${o}']`);let n="",a=null;if(e){const t=e.querySelectorAll(".js-section");t.length>0&&(a=document.createElement("ul"),a.classList.add("sidebar__children","js-sb-sections"),n=" sidebar__item--multi",t.forEach((e=>{const t=document.createElement("li");t.classList.add("sidebar__item","sidebar__item--child","js-sb-sec"),t.innerText=e.querySelector(".js-section-head").textContent,a.append(t),C._contentNodes.push([e,t])})))}else console.warn("Content for sidebar entry not found");const r=t.element(`<div class="sidebar__group js-sb-grp">\n                    <a class="sidebar__item sidebar__item--cat${n} js-sb-cat" data-id="${o}">\n                        ${d.getString(i)}\n                    </a>\n                </div>`);a&&r.append(a),s.append(r)}s.addEventListener("click",C._handleClick),document.addEventListener("scroll",C._scrollHandler),C._scrollHandler()}}const E=[{id:"game2",title:"2game",color:"#523f95"},{id:"allyouplay",title:"AllYouPlay",color:"#e9267b"},{id:"amazonus",title:"Amazon",color:"#fcc588"},{id:"bistore",title:"BI Store",color:"#f74040"},{id:"battlenet",title:"Blizzard",color:"#00cbe6"},{id:"chrono",title:"Chrono.gg",color:"#59c4c5"},{id:"dlgamer",title:"DLGamer",color:"#f5fe94"},{id:"direct2drive",title:"Direct2Drive",color:"#1df884"},{id:"discord",title:"Discord Store",color:"#6f85d4"},{id:"dreamgame",title:"Dreamgame",color:"#497791"},{id:"epic",title:"Epic Game Store",color:"#0078f2"},{id:"bundlestars",title:"Fanatical",color:"#ff9800"},{id:"fireflower",title:"FireFlower",color:"#29698c"},{id:"gog",title:"GOG",color:"#f16421"},{id:"gamejolt",title:"Game Jolt",color:"#2f7f6f"},{id:"gamebillet",title:"GameBillet",color:"#f22f15"},{id:"impulse",title:"GameStop PC",color:"#c63f62"},{id:"gamersgate",title:"GamersGate",color:"#fc5d5d"},{id:"gamesplanetde",title:"GamesPlanet DE",color:"#f6a740"},{id:"gamesplanetfr",title:"GamesPlanet FR",color:"#f6a740"},{id:"gamesplanet",title:"GamesPlanet UK",color:"#f6a740"},{id:"gamesplanetus",title:"GamesPlanet US",color:"#f6a740"},{id:"gamesrepublic",title:"GamesRepublic",color:"#ef0e38"},{id:"gemly",title:"Gemly",color:"#ce2745"},{id:"greenmangaming",title:"GreenManGaming",color:"#21a930"},{id:"humblestore",title:"Humble Store",color:"#ff3e1b"},{id:"humblewidgets",title:"Humble Widgets",color:"#f8300c"},{id:"indiegalastore",title:"IndieGala Store",color:"#ffb4e0"},{id:"itchio",title:"Itch.io",color:"#fa5c5c"},{id:"lbostore",title:"LBOstore",color:"#005268"},{id:"macgamestore",title:"MacGameStore",color:"#0a5092"},{id:"microsoft",title:"Microsoft Store",color:"#ffd800"},{id:"newegg",title:"Newegg",color:"#f79328"},{id:"nuuvem",title:"Nuuvem",color:"#b5e0f4"},{id:"oculus",title:"Oculus Store",color:"#5161a6"},{id:"origin",title:"Origin",color:"#ddff1c"},{id:"playism",title:"Playism",color:"#b8934f"},{id:"razer",title:"Razer Game Store",color:"#00ff00"},{id:"savemi",title:"Savemi",color:"#01add3"},{id:"silagames",title:"SilaGames",color:"#f9cf6b"},{id:"squenix",title:"Square Enix",color:"#b41919"},{id:"steam",title:"Steam",color:"#9ffc3a"},{id:"uplay",title:"Uplay",color:"#01657a"},{id:"voidu",title:"Voidu",color:"#f47820"},{id:"wingamestore",title:"WinGameStore",color:"#0a5092"}];class M{static onClick(e){const t=encodeURIComponent(e.selectionText.trim()),s=M.queryLinks[e.menuItemId];if(s)if("context_steam_keys"===e.menuItemId){const e=t.match(/[A-Z0-9]{5}(-[A-Z0-9]{5}){2}/g);if(!e||0===e.length)return void window.alert(d.str.options.no_keys_found);for(const t of e)browser.tabs.create({url:s.replace("__steamkey__",t)})}else browser.tabs.create({url:s.replace("__query__",t)})}static async build(){await d,await l;for(const e of Object.keys(M.queryLinks))l.get(e)&&browser.contextMenus.create({id:e,title:d.str.options[e].replace("__query__","%s"),contexts:["selection"]},(()=>chrome.runtime.lastError))}static async update(){return await m.contains(["contextMenus"])?(await browser.contextMenus.removeAll(),M.build()):null}}M.queryLinks={context_steam_store:"https://store.steampowered.com/search/?term=__query__",context_steam_market:"https://steamcommunity.com/market/search?q=__query__",context_itad:"https://isthereanydeal.com/search/?q=__query__",context_bartervg:"https://barter.vg/search?q=__query__",context_steamdb:"https://steamdb.info/search/?q=__query__",context_steamdb_instant:"https://steamdb.info/instantsearch/?query=__query__",context_steam_keys:"https://store.steampowered.com/account/registerkey?key=__steamkey__"};class T{static getAdapter(){if(void 0===T._adapter){let e=T.adapters[l.get("user_notes_adapter")];void 0===e&&(l.remove("user_notes_adapter"),e=T.adapters[l.defaults.user_notes_adapter]),T._adapter=new e}return T._adapter}static async changeAdapter(e){const t=T.getAdapter(),s=new T.adapters[e];return await s.import(await t.export()),await t.clear(),T._adapter=s,T._adapter}}class j extends Error{constructor(e,...t){super(...t),this.name=this.constructor.name,this.ratio=e}}class q{constructor(e=!1,t=null){this.closeToFull=e,this.utilization=t}}T.adapters=Object.freeze({synced_storage:class{constructor(){this._notes=l.get("user_notes")}get(e){return this._notes[e]||null}async set(e,t){const s=this._notes[e];this._notes[e]=t;const o=this._getNotesSize()/l.QUOTA_BYTES_PER_ITEM;if(o>1)throw this._notes[e]=s,new j(o,"Can't set this user note, out of capacity");return await l.set("user_notes",this._notes),new q(o>.85,o)}delete(e){return delete this._notes[e],l.set("user_notes",this._notes)}export(){return this._notes}import(e){const t=this._getNotesSize(e)/l.QUOTA_BYTES_PER_ITEM;if(t>1)throw new j(t,"Import to synced storage failed, too much data for this adapter");return this._notes=e,l.set("user_notes",this._notes)}clear(){return l.remove("user_notes")}_getNotesSize(e=this._notes){return"user_notes".length+JSON.stringify(e).length}},idb:class{get(e){return r.action("notes.get",e)}set(e,t){return r.action("notes.set",e,t)}delete(e){return r.action("notes.delete",e)}export(){return r.action("notes.getall")}import(e){return r.action("notes.setall",e)}clear(){return r.action("notes.clear")}}});const A=(()=>{const o={};let i,n;function a(){const e=document.querySelectorAll(".es_sites_icons");switch(i.value){case"color":e.forEach((e=>{e.classList.toggle("es_gray",!1),e.style.display=""}));break;case"gray":e.forEach((e=>{e.classList.toggle("es_gray",!0),e.style.display=""}));break;case"none":e.forEach((e=>{e.style.display="none"}))}}function r(){const e=document.querySelectorAll("[data-setting]");for(const t of e){const e=t.dataset.setting;let s=l.get(e);if(t.type&&"checkbox"===t.type){t.checked=s;const e=t.closest(".parent_option");if(e){"showallstores"===t.id&&(s=!s);let o=e.nextElementSibling;for(;o.classList.contains("js-sub-option");o=o.nextElementSibling)o.classList.toggle("is-disabled",!s)}}else s&&(t.value=s)}document.querySelector(".js-region-select").classList.toggle("is-hidden","off"===l.get("showregionalprice")),document.querySelector(".js-region-world").classList.toggle("is-hidden","mouse"!==l.get("showregionalprice"));const i=l.get("language");if("schinese"!==i&&"tchinese"!==i){const e=document.getElementById("profile_steamrepcn");e&&(e.parentNode.style.display="none")}n||((new s).build(),n=!0),a(),function(){const e=document.querySelector(".js-store-stores"),s=l.get("stores");let o="";for(const e of E){const t=e.id;o+=`<div class="option option--store">\n                        <input type="checkbox" id="${t}"${0===s.length||-1!==s.indexOf(t)?" checked":""}>\n                        <label for="${t}">${e.title}</label>\n                    </div>`}t.inner(e,o)}(),x.populate(),o.customLinks.forEach((e=>e.populate()))}function u({target:e}){const t=new FileReader;t.addEventListener("load",(()=>{let e;try{e=JSON.parse(t.result)}catch(e){return console.group("Import"),console.error("Failed to read settings file"),console.error(e),console.groupEnd(),void window.alert(d.str.options.settings_mngmt.import_fail)}delete e.version;try{l.import(e)}catch(e){return console.group("Import"),console.error("Failed to write settings to storage"),console.error(e),console.groupEnd(),void window.alert(d.str.options.settings_mngmt.import_fail)}window.alert(d.str.options.settings_mngmt.import_success),window.location.reload()})),t.readAsText(e.files[0])}function h(){(class{static download(e,t){const s=document.createElement("a");s.href="string"==typeof e?e:URL.createObjectURL(e),s.download=t,s.dispatchEvent(new MouseEvent("click"))}}).download(new Blob([l.toJson()]),`AugmentedSteam_v${c.version}.json`)}function _(){if(!window.confirm(d.str.options.clear))return;l.clear(!1),l.then(r);const e=document.querySelector(".js-options-reset");e&&p.fadeInFadeOut(e)}async function y(e){let t;if(w.saving(),"stores"===e){t=[];const e=document.querySelectorAll(".js-store-stores input[type=checkbox]");for(const s of e)s.checked&&t.push(s.id)}else{const s=document.querySelector(`[data-setting='${e}']`);if(!s)return;if(t=s.type&&"checkbox"===s.type?s.checked:s.value,"quickinv_diff"===e&&(t=parseFloat(t.trim()).toFixed(2)),g[e])try{let s;if(s=t?await m.requestOption(e):await m.removeOption(e),!s)throw new Error("Could not grant / remove the permissions");g[e].permissions.includes("contextMenus")&&M.update()}catch(e){return console.error(e),void(s.type&&"checkbox"===s.type&&(s.checked=!t))}}"user_notes_adapter"===e&&await T.changeAdapter(t),l.set(e,t),w.saved()}function L(e){if(!e.target||!e.target.closest)return;const t=e.target.closest("[data-setting]");t?y(t.dataset.setting):e.target.closest(".js-store-stores")&&y("stores")}function j(e,t){const s=document.querySelector(e);s.value=t;const o=s.closest("[data-setting]");o&&y(o.dataset.setting)}function q(e){const t=document.getElementById("override_price");e.map((e=>e.abbr)).filter((e=>"USD"!==e)).sort().forEach((e=>{const s=document.createElement("option");s.value=e,s.innerText=e,t.appendChild(s)}))}return o.init=async()=>{await l;const s=e.getJSON("json/currency.json").then(q);await Promise.all([d,s]);const n=l.defaults;o.customLinks=[];for(const e of document.querySelectorAll(".js-customlinks"))o.customLinks.push(new f(e));x.init(),o.customLinks.forEach((e=>e.init())),class{static _buildCheckboxes(){const e=document.querySelectorAll("div[data-dynamic]");for(const s of e){const e=s.dataset.dynamic,o=k.getTranslation(S[e])||S[e];s.classList.add("option");let i="";s.dataset.dynamicColor&&(i=`<div class="option__buttons">\n                              <input type="color" id="${e}_color" data-setting="${e}_color">\n                              <button id="${e}_default">${k.getTranslation("theworddefault")}</button>\n                          </div>`),t.inner(s,`\n                <input type="checkbox" id="${e}" data-setting="${e}">\n                <label class='option__label' for="${e}">${o}</label>\n                ${i}`)}}static _buildSelect(){const e=document.querySelectorAll("div[data-dynamic-select]");for(const s of e){const e=s.dataset.dynamicSelect,o=k.getTranslation(S[e][0]),i=S[e][1];let n="";for(const[e,t]of i)n+=`<option value="${e}">${k.getTranslation(t)}</option>`;s.classList.add("option"),t.inner(s,`\n                <label class='option__label' for="${e}">${o}</label>\n                <select id="${e}" data-setting="${e}">${n}</select>`)}}static _buildWrapped(){const e=document.querySelectorAll("div[data-dynamic-wrap]");for(const s of e){const e=s.dataset.dynamicWrap;s.classList.add("option"),t.inner(s,`\n                    <input type="checkbox" id="${e}" data-setting="${e}">\n                    <label class='option__label' for="${e}">${s.innerHTML}</label>\n                `)}}static build(){this._buildCheckboxes(),this._buildSelect(),this._buildWrapped()}}.build(),i=document.querySelector("select[data-setting='show_profile_link_images']"),i.addEventListener("change",a),r(),await k.translate(),C.create(),await(new b).run(),(new v).build(),["highlight_owned","highlight_wishlist","highlight_coupon","highlight_inv_gift","highlight_inv_guestpass","highlight_notinterested","highlight_waitlist","highlight_collection","tag_owned","tag_wishlist","tag_coupon","tag_inv_gift","tag_inv_guestpass","tag_notinterested","tag_collection","tag_waitlist"].forEach((function(e){document.getElementById(e+"_default").addEventListener("click",(()=>{j(`#${e}_color`,n[e+"_color"])}))})),document.getElementById("spamcommentregex_default").addEventListener("click",(()=>j("#spamcommentregex","[\\u2500-\\u25FF]"))),document.getElementById("quickinv_default").addEventListener("click",(()=>j("#quickinv_diff","-0.01"))),document.getElementById("quickinv_diff").addEventListener("blur",(()=>{isNaN(parseFloat(document.getElementById("quickinv_diff").value))&&j("#quickinv_diff","-0.01")})),document.querySelector("select[data-setting='showregionalprice']").addEventListener("change",(e=>{const t=e.target;document.querySelector(".js-region-select").classList.toggle("is-hidden","off"===t.value),document.querySelector(".js-region-world").classList.toggle("is-hidden","mouse"!==t.value)})),document.querySelectorAll(".parent_option").forEach((e=>{e.querySelector("input").addEventListener("change",(()=>{let t=e.nextElementSibling;for(;t.classList.contains("js-sub-option");t=t.nextElementSibling)t.classList.toggle("is-disabled")}))}));const c=document.getElementById("import_input");c.addEventListener("change",u,!1),document.getElementById("import").addEventListener("click",(()=>{c.click()})),document.getElementById("export").addEventListener("click",h),document.querySelector(".js-reset").addEventListener("click",_),document.addEventListener("change",L),document.addEventListener("blur",L),document.addEventListener("select",L)},o})();document.addEventListener("DOMContentLoaded",A.init)})();
//# sourceMappingURL=options.js.map